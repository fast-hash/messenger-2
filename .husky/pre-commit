#!/bin/sh
set -u
if [ -n "${BASH_VERSION:-}" ]; then
  set -o pipefail
fi
set -e
echo "[pre-commit] format & lint"
npm run format
npm run lint
echo "[pre-commit] quick tests"
npm -w client test
npm -w server test
echo "[pre-commit] secrets scan"
if command -v git-secrets >/dev/null 2>&1; then
  git secrets --scan
else
  echo "git-secrets not installed; skip"
fi
