# Руководство пользователя

## Быстрый старт

1. Запустите сервер и клиент согласно [DEPLOYMENT](DEPLOYMENT.md).
2. Откройте клиент в браузере (`http://localhost:5173` по умолчанию).

## Регистрация и вход

- Заполните форму регистрации: логин, email, пароль и публичный ключ отправляется на сервер вместе с pre-key bundle.【F:server/src/routes/auth.js†L9-L32】【F:server/src/routes/keybundle.js†L5-L34】
- После регистрации/входа JWT сохраняется в `localStorage` и используется при последующих запросах.【F:client/src/api/request.js†L16-L32】【F:client/src/contexts/AuthContext.jsx†L1-L120】

## Работа с чатами

1. Выберите или создайте чат. Клиент загрузит pre-key bundle собеседника и инициализирует Signal-сессию через воркер.【F:client/src/api/api.js†L1-L40】【F:client/src/crypto/signal.js†L178-L226】
2. При отправке сообщение шифруется и отправляется на сервер как `{ chatId, encryptedPayload }`. В UI отображается расшифровка для вас и собеседника.【F:client/src/components/ChatWindow.jsx†L1-L120】
3. История сообщений загружается и расшифровывается автоматически, пока вы авторизованы.【F:client/src/api/api.js†L24-L38】

## Управление ключами

- При первом запуске сохраните пароль-фразу для шифрования identity-ключа; keystore хранится в IndexedDB и может быть восстановлен через `loadIdentity(passphrase)`.【F:client/src/crypto/keystore.js†L200-L252】
- Для смены пароль-фразы экспортируйте и сохраните новый зашифрованный бандл, затем удалите старую запись из IndexedDB.

## Офлайн и повторное подключение

- Если соединение с сервером пропадает, Socket.IO автоматически переподключится и заново присоединится к комнатам, используя сохранённый JWT.【F:server/src/app.js†L78-L142】
- Все сообщения, отправленные офлайн, будут в очереди до восстановления сети в клиентском приложении (Signal воркер кеширует состояние сеансов).【F:client/src/crypto/signal.js†L1-L226】
